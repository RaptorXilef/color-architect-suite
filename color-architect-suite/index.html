<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Felix Maywald / RaptorXilef">
    <meta name="copyright" content="¬© [2025] Felix Maywald">
    <title>Color Architect Suite</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&family=Fira+Code:wght@400;500&display=swap');
        
        :root {
            --panel-bg: #1e293b;
            --app-bg: #0f172a;
            --accent: #3b82f6;
        }

        body { background-color: var(--app-bg); color: #f8fafc; font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; }
        .card { background: var(--panel-bg); border: 1px solid #334155; border-radius: 1.25rem; box-shadow: 0 20px 50px rgba(0,0,0,0.4); }
        
        input[type="color"] { -webkit-appearance: none; border: none; width: 100%; height: 50px; cursor: pointer; border-radius: 0.75rem; background: #334155; padding: 4px; }
        input[type="color"]::-webkit-color-swatch-wrapper { padding: 0; }
        input[type="color"]::-webkit-color-swatch { border: none; border-radius: 0.5rem; }
        
        input[type="text"], input[type="number"], select { background: #0f172a; border: 1px solid #334155; padding: 0.75rem; border-radius: 0.75rem; color: white; width: 100%; text-align: center; font-family: 'Fira Code', monospace; font-size: 0.875rem; outline: none; }
        input:focus { border-color: var(--accent); }

        /* Navigation Farbcodes */
        .tab-btn { transition: all 0.2s; border-bottom: 3px solid transparent; color: #64748b; font-weight: 800; text-transform: uppercase; letter-spacing: 0.1em; font-size: 0.6rem; padding: 1rem 0.6rem; white-space: nowrap; opacity: 0.6; }
        .tab-btn:hover { opacity: 1; color: #f8fafc; }
        .tab-btn.active { opacity: 1; border-bottom-width: 4px; }

        #tab-mix.active { border-color: #3b82f6; color: #3b82f6; }
        #tab-shift.active { border-color: #fbbf24; color: #fbbf24; }
        #tab-contrast.active { border-color: #818cf8; color: #818cf8; }
        #tab-rule.active { border-color: #10b981; color: #10b981; }
        #tab-semantic.active { border-color: #f43f5e; color: #f43f5e; }
        #tab-scale.active { border-color: #a855f7; color: #a855f7; }
        #tab-explorer.active { border-color: #f97316; color: #f97316; }
        #tab-quiet.active { border-color: #2dd4bf; color: #2dd4bf; }
        #tab-layout.active { border-color: #ec4899; color: #ec4899; }
        #tab-glass.active { border-color: #0ea5e9; color: #0ea5e9; }
        #tab-grad.active { border-color: #f59e0b; color: #f59e0b; }
        #tab-typo.active { border-color: #d946ef; color: #d946ef; }
        #tab-shadow.active { border-color: #94a3b8; color: #94a3b8; }
        #tab-access.active { border-color: #6366f1; color: #6366f1; }

        .code-block { background: #0a0f1e; border-radius: 1rem; padding: 1.5rem; font-family: 'Fira Code', monospace; font-size: 0.8rem; border: 1px solid #1e293b; position: relative; overflow-x: auto; color: #94a3b8; box-shadow: inset 0 2px 10px rgba(0,0,0,0.5); }
        .copy-btn { position: absolute; top: 1rem; right: 1rem; background: #334155; padding: 0.4rem 0.8rem; border-radius: 0.5rem; font-size: 0.65rem; cursor: pointer; color: #cbd5e1; font-weight: bold; transition: 0.2s; }
        .copy-btn:hover { background: #475569; color: white; }

        .custom-range { -webkit-appearance: none; width: 100%; height: 6px; background: #334155; border-radius: 5px; outline: none; }
        .custom-range::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 20px; height: 20px; background: var(--accent); cursor: pointer; border-radius: 50%; border: 3px solid #f8fafc; }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .tab-panel { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .preview-area { background: #0f172a; border: 1px dashed #334155; border-radius: 1.25rem; position: relative; overflow: hidden; }
        .label-hint { font-size: 10px; font-weight: 900; color: #64748b; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 0.5rem; display: block; }
        
        /* Accessibility Filters */
        .filter-protanopia { filter: url('#protanopia'); }
        .filter-deuteranopia { filter: url('#deuteranopia'); }
        .filter-tritanopia { filter: url('#tritanopia'); }
        .filter-achromatopsia { filter: grayscale(1); }
    </style>
</head>
<body class="p-4 md:p-12 flex flex-col items-center">

    <!-- SVG Filters for Color Blindness -->
    <svg style="display:none">
        <filter id="protanopia"><feColorMatrix values="0.567, 0.433, 0, 0, 0, 0.558, 0.442, 0, 0, 0, 0, 0.242, 0.758, 0, 0, 0, 0, 0, 1, 0"/></filter>
        <filter id="deuteranopia"><feColorMatrix values="0.625, 0.375, 0, 0, 0, 0.7, 0.3, 0, 0, 0, 0, 0.3, 0.7, 0, 0, 0, 0, 0, 1, 0"/></filter>
        <filter id="tritanopia"><feColorMatrix values="0.95, 0.05, 0, 0, 0, 0, 0.433, 0.567, 0, 0, 0, 0.475, 0.525, 0, 0, 0, 0, 0, 1, 0"/></filter>
    </svg>

    <div class="max-w-7xl w-full">
        <header class="mb-12 text-center text-white">
            <h1 class="text-6xl font-black tracking-tighter bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-indigo-500 to-emerald-400 uppercase italic">
                Color Architect Suite
            </h1>
            <p class="text-slate-500 mt-4 text-lg font-medium tracking-wide">Professional Grade Design Engineering</p>
        </header>

        <!-- Navigation -->
        <div class="overflow-x-auto w-full mb-12 no-scrollbar">
            <nav class="flex min-w-max justify-start md:justify-center space-x-1 md:space-x-2 border-b border-slate-800">
                <button onclick="showTab('mix')" id="tab-mix" class="tab-btn active">Mix Analyzer</button>
                <button onclick="showTab('shift')" id="tab-shift" class="tab-btn">Shift Pro</button>
                <button onclick="showTab('contrast')" id="tab-contrast" class="tab-btn">Contrast</button>
                <button onclick="showTab('rule')" id="tab-rule" class="tab-btn">60-30-10</button>
                <button onclick="showTab('semantic')" id="tab-semantic" class="tab-btn">Semantics</button>
                <button onclick="showTab('scale')" id="tab-scale" class="tab-btn">Scale Pro</button>
                <button onclick="showTab('explorer')" id="tab-explorer" class="tab-btn">Explorer</button>
                <button onclick="showTab('layout')" id="tab-layout" class="tab-btn">Layout</button>
                <button onclick="showTab('quiet')" id="tab-quiet" class="tab-btn">Theme</button>
                <button onclick="showTab('glass')" id="tab-glass" class="tab-btn">Glass</button>
                <button onclick="showTab('grad')" id="tab-grad" class="tab-btn">Gradient</button>
                <button onclick="showTab('typo')" id="tab-typo" class="tab-btn">Typo</button>
                <button onclick="showTab('shadow')" id="tab-shadow" class="tab-btn">Shadow</button>
                <button onclick="showTab('access')" id="tab-access" class="tab-btn">Access</button>
            </nav>
        </div>

        <div id="suite-container" class="space-y-12">
            
            <!-- 1. MIX ANALYZER -->
            <div id="panel-mix" class="tab-panel space-y-8">
                <div class="grid lg:grid-cols-12 gap-8">
                    <div class="lg:col-span-4 card p-8 space-y-6">
                        <h2 class="text-xl font-bold flex items-center gap-2"><span class="text-blue-400">üß™</span> Mix Analyzer</h2>
                        <div class="flex p-1 bg-slate-900 rounded-xl border border-slate-700">
                            <button onclick="setMixMode('bw')" id="mix-mode-bw" class="flex-1 py-2 text-[9px] font-black rounded-lg uppercase bg-blue-600 transition-all">B/W Mix</button>
                            <button onclick="setMixMode('auto')" id="mix-mode-auto" class="flex-1 py-2 text-[9px] font-black rounded-lg uppercase ml-1 transition-all">Auto Partner</button>
                        </div>
                        <div>
                            <span class="label-hint">Basisfarbe</span>
                            <input type="color" id="mixBaseColor" value="#3b82f6" oninput="updateMix();">
                        </div>
                        <div>
                            <span class="label-hint">Wunsch Zielfarbe</span>
                            <input type="color" id="mixTargetColor" value="#0044ff" oninput="updateMix();">
                        </div>
                    </div>
                    <div class="lg:col-span-8 preview-area p-8 flex flex-col items-center justify-center min-h-[300px]">
                        <span class="label-hint mb-4">Visuelle Rezeptur</span>
                        <div id="mixVisualRecipe" class="flex items-center gap-4"></div>
                        <div class="mt-8 grid grid-cols-3 gap-4 w-full max-w-md text-center">
                            <div class="p-4 rounded-xl border border-slate-700 bg-slate-800/50">
                                <span class="label-hint">Base</span>
                                <div id="mixPreviewBase" class="h-12 w-full rounded-lg shadow-inner"></div>
                            </div>
                            <div class="flex items-center justify-center font-black text-slate-700 text-2xl">+</div>
                            <div class="p-4 rounded-xl border border-slate-700 bg-slate-800/50">
                                <span class="label-hint">Partner</span>
                                <div id="mixPreviewPartner" class="h-12 w-full rounded-lg shadow-inner"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="code-block"><button class="copy-btn" onclick="copyContent(event, 'mixOutput')">Copy</button><code id="mixOutput"></code></div>
            </div>

            <!-- 2. SHIFT PRO -->
            <div id="panel-shift" class="tab-panel hidden space-y-8">
                <div class="grid lg:grid-cols-12 gap-8">
                    <div class="lg:col-span-4 card p-8 space-y-6">
                        <h2 class="text-xl font-bold flex items-center gap-2"><span class="text-yellow-400">‚ö°</span> Dynamic Shift</h2>
                        <div class="p-4 bg-slate-900/50 rounded-xl border border-slate-700 space-y-4">
                            <span class="label-hint text-yellow-500">1. Kalibrierung</span>
                            <div class="grid grid-cols-2 gap-3"><input type="color" id="shiftRefBase" value="#3b82f6" oninput="updateShift();"><input type="color" id="shiftRefTarget" value="#0044ff" oninput="updateShift();"></div>
                        </div>
                        <div class="p-4 bg-blue-600/10 rounded-xl border border-blue-500/20"><span class="label-hint">2. Stress-Test</span><input type="color" id="shiftSimBase" value="#3b82f6" oninput="updateShift();"></div>
                    </div>
                    <div class="lg:col-span-8 preview-area p-8">
                        <div class="grid md:grid-cols-2 gap-8 h-full">
                            <div class="bg-slate-900/80 p-6 rounded-2xl border border-slate-700 flex flex-col justify-center gap-6 shadow-2xl">
                                <span id="menuLabel1" class="text-[11px] font-black uppercase transition-all duration-300">Projekt Management</span>
                                <span id="menuLabel2" class="text-[11px] font-black uppercase transition-all duration-300">Team Kommunikation</span>
                                <div id="activeDot" class="w-8 h-2 rounded-full transition-all"></div>
                            </div>
                            <div class="flex flex-col justify-center gap-4">
                                <div class="p-4 rounded-xl bg-slate-800 border border-slate-700 flex items-center justify-between"><span class="label-hint">Base</span><div id="simBaseIndicator" class="w-10 h-10 rounded"></div></div>
                                <div class="p-4 rounded-xl bg-slate-800 border border-slate-700 flex items-center justify-between"><span class="label-hint">Shift</span><div id="simTargetIndicator" class="w-10 h-10 rounded"></div></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="code-block"><button class="copy-btn" onclick="copyContent(event, 'shiftOutput')">Copy</button><code id="shiftOutput"></code></div>
            </div>

            <!-- 3. CONTRAST -->
            <div id="panel-contrast" class="tab-panel hidden space-y-8">
                <div class="grid lg:grid-cols-12 gap-8">
                    <div class="lg:col-span-4 card p-8 space-y-6">
                        <h2 class="text-xl font-bold flex items-center gap-2"><span class="text-indigo-400">üëÅÔ∏è</span> Contrast</h2>
                        <div><span class="label-hint">Hintergrund</span><input type="color" id="conBgColor" value="#3b82f6" oninput="updateContrast();"></div>
                        <div class="grid grid-cols-2 gap-4">
                            <div><span class="label-hint">Dark Text</span><input type="color" id="conDarkText" value="#0f172a" oninput="updateContrast();"></div>
                            <div><span class="label-hint">Light Text</span><input type="color" id="conLightText" value="#f8fafc" oninput="updateContrast();"></div>
                        </div>
                    </div>
                    <div id="conPreview" class="lg:col-span-8 preview-area flex flex-col items-center justify-center p-12">
                        <h3 id="conPreviewText" class="text-5xl font-black mb-4 uppercase italic">Vorschau</h3>
                        <p id="ratioRes" class="text-2xl font-black"></p>
                        <div id="wcagBadge" class="mt-4 px-6 py-1 rounded-full text-[10px] font-black text-white uppercase">Checking...</div>
                    </div>
                </div>
                <div class="code-block flex justify-around py-8 text-center">
                   <div><span class="label-hint">WCAG AA</span><div id="aaStatus" class="text-2xl">?</div></div>
                   <div><span class="label-hint">WCAG AAA</span><div id="aaaStatus" class="text-2xl">?</div></div>
                </div>
            </div>

            <!-- 4. 60-30-10 -->
            <div id="panel-rule" class="tab-panel hidden space-y-8">
                <div class="grid lg:grid-cols-12 gap-8">
                    <div class="lg:col-span-4 card p-8 space-y-6">
                        <h2 class="text-xl font-bold flex items-center gap-2"><span class="text-emerald-400">üìê</span> Harmony Rule - 60-30-10</h2>
                        <div class="flex p-1 bg-slate-900 rounded-xl border border-slate-700">
                            <button onclick="setRuleMode('light')" id="rule-l" class="flex-1 py-2 text-[9px] font-black rounded-lg uppercase">Light Theme</button>
                            <button onclick="setRuleMode('dark')" id="rule-d" class="flex-1 py-2 text-[9px] font-black rounded-lg uppercase ml-1 bg-blue-600">Dark Theme</button>
                        </div>
                        <div>
                            <span class="label-hint">Akzentfarbe</span>
                        <input type="color" id="ruleAccent" value="#3b82f6" oninput="updateRule();">
                        </div>
                    </div>
                    <div class="lg:col-span-8 preview-area p-8 flex flex-col justify-center">
                        <span class="label-hint mb-4">Verh√§ltnis Bar</span>
                        <div class="h-32 w-full rounded-2xl flex overflow-hidden border border-slate-800 shadow-2xl" id="ruleBar"></div>
                        <div class="grid grid-cols-3 mt-4 text-[10px] font-bold text-slate-500 italic">
                            <span>60% Base</span>
                            <span class="text-center">30% Secondary</span>
                            <span class="text-right">10% Accent</span>
                        </div>
                    </div>
                </div>
                <div class="code-block"><button class="copy-btn" onclick="copyContent(event, 'ruleOutput')">Copy</button><pre id="ruleOutput"></pre></div>
            </div>

            <!-- 5. SEMANTICS -->
            <div id="panel-semantic" class="tab-panel hidden space-y-8">
                <div class="grid lg:grid-cols-12 gap-8">
                    <div class="lg:col-span-4 card p-8 space-y-6">
                        <h2 class="text-xl font-bold flex items-center gap-2"><span class="text-rose-400">üé®</span> UI Semantics</h2>
                        <div>
                            <span class="label-hint">Brand Basis</span>
                            <input type="color" id="semBase" value="#3b82f6" oninput="updateSemantic();">
                        </div>
                    </div>
                    <div class="lg:col-span-8 preview-area p-8">
                        <span class="label-hint mb-6">Status Farben (Tints)</span>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4" id="semContainer"></div>
                    </div>
                </div>
                <div class="code-block"><button class="copy-btn" onclick="copyContent(event, 'semOutput')">Copy</button><pre id="semOutput"></pre></div>
            </div>

            <!-- 6. SCALE PRO -->
            <div id="panel-scale" class="tab-panel hidden space-y-8">
                <div class="grid lg:grid-cols-12 gap-8">
                    <div class="lg:col-span-4 card p-8 space-y-6">
                        <h2 class="text-xl font-bold flex items-center gap-2"><span class="text-purple-400">ü™ú</span> Scale Pro</h2>
                        <div class="flex p-1 bg-slate-900 rounded-xl border border-slate-700">
                            <button onclick="setScaleType('mono')" id="sc-mono" class="flex-1 py-2 text-[9px] font-black rounded-lg bg-blue-600 uppercase">Monochrom</button>
                            <button onclick="setScaleType('duo')" id="sc-duo" class="flex-1 py-2 text-[9px] font-black rounded-lg ml-1 uppercase">Duo-Tone</button>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div><span class="label-hint">Basis A</span><input type="color" id="scaleA" value="#3b82f6" oninput="updateScale();"></div>
                            <div id="scaleBWrapper" class="hidden"><span class="label-hint">Ende B</span><input type="color" id="scaleB" value="#10b981" oninput="updateScale();"></div>
                        </div>
                        <div>
                            <span class="label-hint">Stufen: <span id="scCountText" class="text-blue-400">7</span></span>
                            <input type="range" id="scaleCount" min="3" max="15" step="2" value="7" oninput="updateScale();" class="custom-range">
                        </div>
                    </div>
                    <div class="lg:col-span-8 preview-area p-8 flex flex-col justify-center">
                        <span class="label-hint mb-4">Gradient Scale Preview</span>
                        <div id="scalePreview" class="h-24 w-full flex rounded-2xl overflow-hidden shadow-2xl border border-slate-800"></div>
                    </div>
                </div>
                <div class="code-block"><button class="copy-btn" onclick="copyContent(event, 'scaleOutput')">Copy</button><pre id="scaleOutput"></pre></div>
            </div>

            <!-- 7. EXPLORER -->
            <div id="panel-explorer" class="tab-panel hidden space-y-8">
                <div class="grid lg:grid-cols-12 gap-8">
                    <div class="lg:col-span-4 card p-8 space-y-6">
                        <h2 class="text-xl font-bold flex items-center gap-2"><span class="text-orange-400">üîç</span> Explorer</h2>
                        <div>
                            <span class="label-hint">Zentralfarbe</span>
                            <input type="color" id="expBase" value="#0f172a" oninput="updateExplorer();">
                        </div>
                    </div>
                    <div class="lg:col-span-8 preview-area p-8 space-y-4 max-h-[550px] overflow-y-auto no-scrollbar" id="expResults">
                        <!-- Hier kommen die Karten rein -->
                    </div>
                </div>
            </div>
            

            <!-- 8. LAYOUT PRO (NEU) -->
            <div id="panel-layout" class="tab-panel hidden space-y-8">
                <div class="grid lg:grid-cols-12 gap-8">
                    <div class="lg:col-span-4 card p-8 space-y-6">
                        <h2 class="text-xl font-bold flex items-center gap-2"><span class="text-pink-400">üìè</span> Layout Pro</h2>
                        <div><span class="label-hint">Scale Factor (px)</span><input type="number" id="layoutScale" value="8" min="2" max="16" oninput="updateLayout();"></div>
                        <div><span class="label-hint">Base Radius</span><input type="range" id="layoutRadius" min="0" max="32" value="12" oninput="updateLayout();" class="custom-range"></div>
                    </div>
                    <div class="lg:col-span-8 preview-area p-8 grid grid-cols-2 gap-8">
                        <div id="layoutBox1" class="border border-slate-700 flex flex-col gap-4 p-4">
                            <span class="label-hint">Container Scale</span>
                            <div class="bg-blue-500/20 h-full w-full border border-blue-500/40 transition-all"></div>
                        </div>
                        <div class="space-y-4">
                            <div class="bg-slate-800 p-4 border border-slate-700 flex items-center gap-4 transition-all" id="layoutItem1">
                                <div class="w-8 h-8 bg-blue-500 shrink-0"></div>
                                <div class="h-2 w-full bg-slate-600 rounded"></div>
                            </div>
                            <div class="bg-slate-800 p-4 border border-slate-700 flex items-center gap-4 transition-all" id="layoutItem2">
                                <div class="w-8 h-8 bg-emerald-500 shrink-0"></div>
                                <div class="h-2 w-full bg-slate-600 rounded"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="code-block"><button class="copy-btn" onclick="copyContent(event, 'layoutOutput')">Copy</button><pre id="layoutOutput"></pre></div>
            </div>

            <!-- 8. THEME ARCHITECT -->
            <div id="panel-quiet" class="tab-panel hidden space-y-8">
                <div class="grid lg:grid-cols-12 gap-8">
                    <div class="lg:col-span-4 card p-8 space-y-6">
                        <h2 class="text-xl font-bold flex items-center gap-2"><span class="text-teal-400">üåø</span> Theme Architect</h2>
                        <div class="flex p-1 bg-slate-900 rounded-xl border border-slate-800">
                            <button onclick="setThemeMode('light')" id="tm-l" class="flex-1 py-2 text-[9px] font-black rounded-lg uppercase">Light</button>
                            <button onclick="setThemeMode('dark')" id="tm-d" class="flex-1 py-2 text-[9px] font-black rounded-lg uppercase ml-1 bg-blue-600">Dark</button>
                        </div>
                        <div>
                            <span class="label-hint">Basis Ton</span>
                            <input type="color" id="quietBase" value="#0A192F" oninput="updateQuiet();">
                        </div>
                    </div>
                    <div class="lg:col-span-8 preview-area p-8">
                         <div id="uiPreview" class="rounded-3xl p-6 flex border transition-all duration-500 shadow-2xl relative overflow-hidden h-full min-h-[250px]">
                            <div id="uiSidebar" class="w-1/3 rounded-2xl p-4 border transition-all duration-500 mr-4">
                                <div class="w-full h-3 rounded-full opacity-20 mb-3 bg-current"></div>
                                <div class="w-2/3 h-3 rounded-full opacity-10 bg-current"></div>
                            </div>
                            <div id="uiContent" class="flex-1 rounded-2xl p-6 border transition-all duration-500 relative text-white">
                                <h4 class="font-bold text-lg mb-4 uppercase tracking-tighter text-blue-400">Layout Preview</h4>
                                <div class="w-full h-24 rounded-xl mb-4 bg-current opacity-5 border border-current"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="code-block"><button class="copy-btn" onclick="copyContent(event, 'quietOutput')">Copy</button><pre id="quietOutput"></pre></div>
            </div>

            <!-- 9. GLASS ARCHITECT -->
            <div id="panel-glass" class="tab-panel hidden space-y-8">
                <div class="grid lg:grid-cols-12 gap-8">
                    <div class="lg:col-span-4 card p-8 space-y-6">
                        <h2 class="text-xl font-bold flex items-center gap-2"><span class="text-sky-400">üíé</span> Glass Architect</h2>
                        <div><span class="label-hint">Border context</span><input type="color" id="glassContext" value="#0f172a" oninput="updateGlass();"></div>
                        <div><span class="label-hint">Visual BG</span><input type="color" id="glassVisualBg" value="#1e293b" oninput="updateGlass();"></div>
                        <div><span class="label-hint">Alpha: <span id="glassOpacityVal">20%</span></span><input type="range" id="glassOpacity" min="5" max="60" step="5" value="20" oninput="updateGlass();" class="custom-range"></div>
                        <div><span class="label-hint">Blur: <span id="glassBlurVal">12px</span></span><input type="range" id="glassBlur" min="0" max="40" step="1" value="12" oninput="updateGlass();" class="custom-range"></div>
                        <input type="file" id="glassImageInput" accept="image/*" onchange="handleVisualBgImage(this, 'glassPreviewContainer')" class="block w-full text-[9px] text-slate-500 cursor-pointer">
                    </div>
                    <div id="glassPreviewContainer" class="lg:col-span-8 preview-area flex items-center justify-center bg-cover bg-center transition-all min-h-[350px]">
                         <div id="glassPreviewPane" class="w-full max-w-sm p-12 rounded-3xl border transition-all duration-300 relative z-10 text-center">
                                <h4 class="text-3xl font-black mb-2 uppercase tracking-tight">Frosted</h4>
                                <p class="text-xs opacity-60">Glass UI Component</p>
                         </div>
                    </div>
                </div>
                <div class="code-block"><button class="copy-btn" onclick="copyContent(event, 'glassOutput')">Copy</button><pre id="glassOutput"></pre></div>
            </div>

            <!-- 10. GRADIENT -->
            <div id="panel-grad" class="tab-panel hidden space-y-8">
                <div class="grid lg:grid-cols-12 gap-8">
                    <div class="lg:col-span-4 card p-8 space-y-6">
                        <h2 class="text-xl font-bold flex items-center gap-2"><span class="text-orange-400">üî•</span> Gradient Lab</h2>
                        <div class="grid grid-cols-2 gap-4"><input type="color" id="gradStart" value="#3b82f6" oninput="updateGradient();"><input type="color" id="gradEnd" value="#10b981" oninput="updateGradient();"></div>
                        <div><span class="label-hint">Angle: <span id="gradAngleVal">135deg</span></span><input type="range" id="gradAngle" min="0" max="360" step="15" value="135" oninput="updateGradient();" class="custom-range"></div>
                        <div class="flex items-center gap-2"><input type="checkbox" id="gradSoft" onchange="updateGradient();" class="w-4 h-4"><label class="text-[10px] font-black uppercase text-slate-500">Soft Transition</label></div>
                    </div>
                    <div id="gradPreview" class="lg:col-span-8 preview-area h-[350px] shadow-2xl transition-all flex items-center justify-center">
                        <span class="text-white font-black text-4xl uppercase tracking-widest opacity-20"><!---Preview--></span>
                    </div>
                </div>
                <div class="code-block"><button class="copy-btn" onclick="copyContent(event, 'gradOutput')">Copy</button><pre id="gradOutput"></pre></div>
            </div>

            <!-- 11. TYPO -->
            <div id="panel-typo" class="tab-panel hidden space-y-8">
                <div class="grid lg:grid-cols-12 gap-8">
                    <div class="lg:col-span-4 card p-8 space-y-6">
                        <h2 class="text-xl font-bold flex items-center gap-2"><span class="text-pink-400">üìè</span> Typo Scale</h2>
                        <div><span class="label-hint">Base Size (px)</span><input type="number" id="typoBase" value="16" min="12" max="24" oninput="updateTypo();"></div>
                        <div><span class="label-hint">Ratio</span>
                            <select id="typoRatio" onchange="updateTypo();">
                                <option value="1.067">Minor Second (1.067)</option>
                                <option value="1.200">Minor Third (1.200)</option>
                                <option value="1.250" selected>Major Third (1.250)</option>
                                <option value="1.333">Perfect Fourth (1.333)</option>
                                <option value="1.618">Golden Ratio (1.618)</option>
                            </select>
                        </div>
                    </div>
                    <div class="lg:col-span-8 card p-8 preview-area overflow-y-auto max-h-[400px]">
                        <div id="typoPreview" class="space-y-6"></div>
                    </div>
                </div>
                <div class="code-block"><button class="copy-btn" onclick="copyContent(event, 'typoOutput')">Copy</button><pre id="typoOutput"></pre></div>
            </div>

            <!-- 12. SHADOW -->
            <div id="panel-shadow" class="tab-panel hidden space-y-8">
                <div class="grid lg:grid-cols-12 gap-8">
                    <div class="lg:col-span-4 card p-8 space-y-6">
                        <h2 class="text-xl font-bold flex items-center gap-2"><span class="text-slate-400">üåë</span> Shadow Pro</h2>
                        <div><span class="label-hint">Schatten Farbe</span><input type="color" id="shadColor" value="#000000" oninput="updateShadow();"></div>
                        <div><span class="label-hint">HG Farbe</span><input type="color" id="shadVisualBg" value="#1e293b" oninput="updateShadow();"></div>
                        <div><span class="label-hint">Intensit√§t</span><input type="range" id="shadIntensity" min="5" max="50" step="1" value="20" oninput="updateShadow();" class="custom-range"></div>
                        <input type="file" id="shadImageInput" accept="image/*" onchange="handleVisualBgImage(this, 'shadPreviewContainer')" class="block w-full text-[9px] text-slate-500 cursor-pointer">
                    </div>
                    <div id="shadPreviewContainer" class="lg:col-span-8 preview-area min-h-[350px] flex items-center justify-center bg-cover bg-center">
                        <div id="shadPreviewBox" class="w-40 h-40 bg-white rounded-3xl"></div>
                    </div>
                </div>
                <div class="code-block"><button class="copy-btn" onclick="copyContent(event, 'shadOutput')">Copy</button><pre id="shadOutput"></pre></div>
            </div>



            <!-- 14. ACCESSIBILITY (NEU) -->
            <div id="panel-access" class="tab-panel hidden space-y-8">
                <div class="grid lg:grid-cols-12 gap-8">
                    <div class="lg:col-span-4 card p-8 space-y-6">
                        <h2 class="text-xl font-bold flex items-center gap-2"><span class="text-indigo-500">‚ôø</span> Accessibility</h2>
                        <div><span class="label-hint">Pr√ºffarbe</span><input type="color" id="accessColor" value="#3b82f6" oninput="updateAccess();"></div>
                        <div class="space-y-2">
                            <label class="flex items-center gap-2 p-3 bg-slate-900 rounded-xl cursor-pointer hover:bg-slate-800 transition-all">
                                <input type="radio" name="vision" value="normal" checked onchange="updateAccess();"> <span class="text-xs">Normal Vision</span>
                            </label>
                            <label class="flex items-center gap-2 p-3 bg-slate-900 rounded-xl cursor-pointer hover:bg-slate-800 transition-all">
                                <input type="radio" name="vision" value="protanopia" onchange="updateAccess();"> <span class="text-xs">Protanopia (No Red)</span>
                            </label>
                            <label class="flex items-center gap-2 p-3 bg-slate-900 rounded-xl cursor-pointer hover:bg-slate-800 transition-all">
                                <input type="radio" name="vision" value="deuteranopia" onchange="updateAccess();"> <span class="text-xs">Deuteranopia (No Green)</span>
                            </label>
                            <label class="flex items-center gap-2 p-3 bg-slate-900 rounded-xl cursor-pointer hover:bg-slate-800 transition-all">
                                <input type="radio" name="vision" value="achromatopsia" onchange="updateAccess();"> <span class="text-xs">Achromatopsia</span>
                            </label>
                        </div>
                    </div>
                    <div class="lg:col-span-8 preview-area p-8 flex flex-col items-center justify-center">
                        <div id="accessPreview" class="grid grid-cols-2 gap-4 w-full max-w-md">
                            <div class="h-32 rounded-3xl shadow-xl flex items-center justify-center font-black" style="background:#3b82f6">UI</div>
                            <div class="h-32 rounded-3xl shadow-xl flex items-center justify-center font-black" style="background:#ef4444">ERROR</div>
                            <div class="h-32 rounded-3xl shadow-xl flex items-center justify-center font-black" style="background:#10b981">SUCCESS</div>
                            <div class="h-32 rounded-3xl shadow-xl flex items-center justify-center font-black" style="background:#f59e0b">WARN</div>
                        </div>
                        <p class="mt-6 text-[10px] text-slate-500 uppercase font-black tracking-widest italic">Simulation der Farbwahrnehmung</p>
                    </div>
                </div>
            </div>


    <script>
        // --- GLOBALS ---
        let ruleMode = 'dark', scaleType = 'mono', themeMode = 'dark', mixMode = 'bw';

        // --- MATH HELPERS ---
        function safeHexToRgb(hex) {
            const res = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return res ? { r: parseInt(res[1], 16), g: parseInt(res[2], 16), b: parseInt(res[3], 16) } : {r:0,g:0,b:0};
        }
        const rgbToHex = (r, g, b) => "#" + ((1 << 24) + (Math.max(0, Math.min(255, r)) << 16) + (Math.max(0, Math.min(255, g)) << 8) + Math.max(0, Math.min(255, b))).toString(16).slice(1).toUpperCase();
        
        const rgbToHsl = (r, g, b) => {
            r /= 255, g /= 255, b /= 255;
            let max = Math.max(r, g, b), min = Math.min(r, g, b), h, s, l = (max + min) / 2;
            if(max == min) { h = s = 0; } else {
                let d = max - min; s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch(max){ case r: h = (g - b) / d + (g < b ? 6 : 0); break; case g: h = (b - r) / d + 2; break; case b: h = (r - g) / d + 4; break; }
                h /= 6;
            } return { h: h * 360, s: s * 100, l: l * 100 };
        };

        const hslToRgb = (h, s, l) => {
            s /= 100; l /= 100; h /= 360;
            let r, g, b;
            if(s == 0){ r = g = b = l; } else {
                const q2r = (p, q, t) => { if(t < 0) t += 1; if(t > 1) t -= 1; if(t < 1/6) return p + (q - p) * 6 * t; if(t < 1/2) return q; if(t < 2/3) return p + (q - p) * (2/3 - t) * 6; return p; };
                let q = l < 0.5 ? l * (1 + s) : l + s - l * s, p = 2 * l - q;
                r = q2r(p, q, h + 1/3); g = q2r(p, q, h); b = q2r(p, q, h - 1/3);
            } return { r: Math.round(r * 255), g: Math.round(g * 255), b: Math.round(b * 255), hex: rgbToHex(Math.round(r*255), Math.round(g*255), Math.round(b*255)) };
        };

        const mixColors = (c1, c2, w) => {
            const r = Math.round(c1.r * w + c2.r * (1-w)), g = Math.round(c1.g * w + c2.g * (1-w)), b = Math.round(c1.b * w + c2.b * (1-w));
            return { r, g, b, hex: rgbToHex(r,g,b) };
        };
        const getYIQ = (rgb) => ((rgb.r * 299) + (rgb.g * 587) + (rgb.b * 114)) / 1000;
        const getLuminance = (rgb) => {
            let a = [rgb.r, rgb.g, rgb.b].map(v => { v /= 255; return v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4); });
            return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722;
        };
        const getContrast = (c1, c2) => {
            let l1 = getLuminance(c1) + 0.05, l2 = getLuminance(c2) + 0.05;
            return l1 > l2 ? l1 / l2 : l2 / l1;
        };

        // --- UPDATERS ---
        function updateShift() {
            const refBase = safeHexToRgb(document.getElementById('shiftRefBase').value);
            const refTarget = safeHexToRgb(document.getElementById('shiftRefTarget').value);
            const simBase = safeHexToRgb(document.getElementById('shiftSimBase').value);
            const refBaseHsl = rgbToHsl(refBase.r, refBase.g, refBase.b);
            const refTargetHsl = rgbToHsl(refTarget.r, refTarget.g, refTarget.b);
            const delta = { h: refTargetHsl.h - refBaseHsl.h, s: refTargetHsl.s - refBaseHsl.s, l: refTargetHsl.l - refBaseHsl.l };
            const simBaseHsl = rgbToHsl(simBase.r, simBase.g, simBase.b);
            const finalHsl = { h: (simBaseHsl.h + delta.h + 360) % 360, s: Math.max(0, Math.min(100, simBaseHsl.s + delta.s)), l: Math.max(0, Math.min(100, simBaseHsl.l + delta.l)) };
            const finalRgb = hslToRgb(finalHsl.h, finalHsl.s, finalHsl.l);
            document.getElementById('simBaseIndicator').style.backgroundColor = document.getElementById('shiftSimBase').value;
            document.getElementById('simTargetIndicator').style.backgroundColor = finalRgb.hex;
            document.getElementById('menuLabel1').style.color = finalRgb.hex;
            document.getElementById('menuLabel2').style.color = finalRgb.hex;
            document.getElementById('activeDot').style.backgroundColor = finalRgb.hex;
            document.getElementById('shiftOutput').innerText = `$menu-header: adjust-color($primary-base, $hue: ${delta.h.toFixed(1)}deg, $saturation: ${delta.s.toFixed(1)}%, $lightness: ${delta.l.toFixed(1)}%);`;
        }

        function setMixMode(m) { mixMode = m; document.getElementById('mix-mode-bw').classList.toggle('bg-blue-600', m==='bw'); document.getElementById('mix-mode-auto').classList.toggle('bg-blue-600', m==='auto'); updateMix(); }
        function updateMix() {
            const bR = safeHexToRgb(document.getElementById('mixBaseColor').value), tR = safeHexToRgb(document.getElementById('mixTargetColor').value);
            const vis = document.getElementById('mixVisualRecipe'); vis.innerHTML = ''; let scss = '';
            document.getElementById('mixPreviewBase').style.backgroundColor = document.getElementById('mixBaseColor').value;
            if (mixMode === 'bw') {
                let p = (tR.r+tR.g+tR.b)/3 > (bR.r+bR.g+bR.b)/3 ? {r:255,g:255,b:255,n:'white'} : {r:0,g:0,b:0,n:'black'};
                const ds = [(tR.r-bR.r)/(p.r-bR.r), (tR.g-bR.g)/(p.g-bR.g), (tR.b-bR.b)/(p.b-bR.b)].filter(v=>isFinite(v)&&!isNaN(v));
                const w = ds.length > 0 ? Math.round((ds.reduce((x,y)=>x+y)/ds.length)*100) : 0;
                scss = `mix(${p.n}, $brand-primary, ${Math.max(0, w)}%)`;
                document.getElementById('mixPreviewPartner').style.backgroundColor = p.n;
                vis.innerHTML = `<div class="w-12 h-12 rounded-lg" style="background:${document.getElementById('mixBaseColor').value}"></div> <span class="text-slate-500 font-bold">+</span> <div class="w-12 h-12 rounded-lg" style="background:${p.n}"></div>`;
            } else {
                let bestW = 0.01;
                for(let w=0.01; w<=1.0; w+=0.01) {
                    const r = (tR.r - bR.r * (1-w)) / w; const g = (tR.g - bR.g * (1-w)) / w; const b = (tR.b - bR.b * (1-w)) / w;
                    if(r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255) { bestW = w; break; }
                }
                const pR = Math.round((tR.r - bR.r * (1-bestW)) / bestW), pG = Math.round((tR.g - bR.g * (1-bestW)) / bestW), pB = Math.round((tR.b - bR.b * (1-bestW)) / bestW);
                const pHex = rgbToHex(pR, pG, pB); scss = `mix(${pHex}, $brand-primary, ${Math.round(bestW * 100)}%)`;
                document.getElementById('mixPreviewPartner').style.backgroundColor = pHex;
                vis.innerHTML = `<div class="w-12 h-12 rounded-lg shadow-xl border border-slate-700" style="background:${document.getElementById('mixBaseColor').value}"></div> <span class="text-slate-500 font-bold">+</span> <div class="w-12 h-12 rounded-lg shadow-xl border border-slate-700" style="background:${pHex}"></div>`;
            }
            document.getElementById('mixOutput').innerText = scss;
        }

        function updateContrast() {
            const bgH = document.getElementById('conBgColor').value, bg = safeHexToRgb(bgH), isL = getYIQ(bg) >= 128;
            const darkH = document.getElementById('conDarkText').value, lightH = document.getElementById('conLightText').value;
            const r = getContrast(bg, isL ? safeHexToRgb(darkH) : safeHexToRgb(lightH)).toFixed(2);
            document.getElementById('conPreview').style.backgroundColor = bgH; document.getElementById('conPreviewText').style.color = isL ? darkH : lightH;
            document.getElementById('ratioRes').innerText = `${r} : 1`;
            const b = document.getElementById('wcagBadge'); b.innerText = r >= 4.5 ? (r >= 7 ? "WCAG AAA" : "WCAG AA") : "FAIL";
            b.style.backgroundColor = r >= 4.5 ? (r >= 7 ? "#10b981" : "#3b82f6") : "#ef4444";
            document.getElementById('aaStatus').innerText = r >= 4.5 ? "‚úÖ" : "‚ùå"; document.getElementById('aaaStatus').innerText = r >= 7 ? "‚úÖ" : "‚ùå";
        }

        function updateLayout() {
            const scale = document.getElementById('layoutScale').value, rad = document.getElementById('layoutRadius').value;
            const box = document.getElementById('layoutBox1'), i1 = document.getElementById('layoutItem1'), i2 = document.getElementById('layoutItem2');
            box.style.padding = (scale * 2) + "px"; box.style.borderRadius = rad + "px";
            [i1, i2].forEach(el => el.style.borderRadius = (rad/2) + "px");
            document.getElementById('layoutOutput').innerText = `$scale: ${scale}px;\n$radius-lg: ${rad}px;\n$radius-md: ${rad/2}px;\n$padding: $scale * 2;`;
        }

        function updateAccess() {
            const mode = document.querySelector('input[name="vision"]:checked').value;
            const prev = document.getElementById('accessPreview');
            prev.className = "grid grid-cols-2 gap-4 w-full max-w-md filter-" + mode;
            if(mode === 'normal') prev.className = "grid grid-cols-2 gap-4 w-full max-w-md";
        }

        // --- CORE MODULES COPIED FROM PREVIOUS VERSION ---
        function setRuleMode(m) { ruleMode = m; updateRule(); }
        function updateRule() {
            const accH = document.getElementById('ruleAccent').value, acc = safeHexToRgb(accH);
            let b = ruleMode === 'light' ? "#F8FAFC" : "#0F172A", s = ruleMode === 'light' ? mixColors(acc, {r:255,g:255,b:255}, 0.1).hex : mixColors(acc, {r:15,g:23,b:42}, 0.15).hex;
            document.getElementById('ruleBar').innerHTML = `<div style="width:60%; background:${b}"></div><div style="width:30%; background:${s}"></div><div style="width:10%; background:${accH}"></div>`;
            document.getElementById('ruleOutput').innerText = `$base: ${b};\n$secondary: ${s};\n$accent: ${accH};`;
            document.getElementById('rule-l').classList.toggle('bg-blue-600', ruleMode==='light'); document.getElementById('rule-d').classList.toggle('bg-blue-600', ruleMode==='dark');
        }

        function updateSemantic() {
            const brand = safeHexToRgb(document.getElementById('semBase').value);
            const states = [{n:'Info', c:{r:59,g:130,b:246}}, {n:'Success', c:{r:34,g:197,b:94}}, {n:'Warning', c:{r:234,g:179,b:8}}, {n:'Danger', c:{r:239,g:68,b:68}}];
            const cont = document.getElementById('semContainer'); cont.innerHTML = ''; let scss = '$semantic: (\n';
            states.forEach(s => {
                const tint = mixColors(brand, s.c, 0.2), txt = getYIQ(tint) >= 128 ? "#000" : "#fff";
                cont.innerHTML += `<div class="p-6 rounded-2xl flex flex-col items-center justify-center font-black text-[10px] shadow-lg border border-slate-700/50" style="background:${tint.hex}; color:${txt}"><span>${s.n.toUpperCase()}</span><span class="mt-2 font-mono opacity-50">${tint.hex}</span></div>`;
                scss += `  "${s.n.toLowerCase()}": ( "bg": ${tint.hex}, "text": ${txt} ),\n`;
            });
            scss += ');'; document.getElementById('semOutput').innerText = scss;
        }

        function setScaleType(t) { scaleType = t; updateScale(); }
        function updateScale() {
            const a = safeHexToRgb(document.getElementById('scaleA').value), b = safeHexToRgb(document.getElementById('scaleB').value), count = parseInt(document.getElementById('scaleCount').value);
            document.getElementById('scCountText').innerText = count;
            document.getElementById('sc-mono').classList.toggle('bg-blue-600', scaleType==='mono'); document.getElementById('sc-duo').classList.toggle('bg-blue-600', scaleType==='duo');
            document.getElementById('scaleBWrapper').classList.toggle('hidden', scaleType!=='duo');
            const prev = document.getElementById('scalePreview'); prev.innerHTML = ''; let scss = '$scale: (\n';
            for(let i=0; i<count; i++) {
                const w = i / (count-1);
                let c = scaleType === 'mono' ? (w < 0.5 ? mixColors(a, {r:255,g:255,b:255}, w*2) : mixColors({r:0,g:0,b:0}, a, (w-0.5)*2)) : mixColors(b, a, w);
                prev.innerHTML += `<div style="flex:1; background:${c.hex}"></div>`; scss += `  "${(i+1)*100}": ${c.hex},\n`;
            }
            scss += ');'; document.getElementById('scaleOutput').innerText = scss;
        }

        function updateExplorer() {
            const bgH = document.getElementById('expBase').value, bg = safeHexToRgb(bgH), hsl = rgbToHsl(bg.r, bg.g, bg.b), res = document.getElementById('expResults'); res.innerHTML = '';
            const hars = [{n:'Komplement√§r', h:180}, {n:'Triadisch A', h:120}, {n:'Triadisch B', h:240}, {n:'Analog A', h:30}, {n:'Analog B', h:330}];
            hars.forEach(h => {
                const acc = hslToRgb((hsl.h + h.h) % 360, Math.max(hsl.s, 60), Math.max(hsl.l, 50)), ratio = getContrast(bg, acc).toFixed(1);
                res.innerHTML += `<div class="card p-5 flex items-center justify-between border-l-4" style="border-left-color:${acc.hex}"><div><p class="text-[10px] font-bold text-slate-500 uppercase">${h.n}</p><p class="text-sm font-mono">${acc.hex}</p></div><div class="flex items-center space-x-6"><div class="px-4 py-2 rounded font-bold text-xs shadow" style="background:${acc.hex}; color:${getYIQ(acc)>=128?'#000':'#fff'}">BTN</div><div class="text-sm font-bold ${ratio>=4.5?'text-emerald-400':'text-red-400'}">${ratio}:1</div></div></div>`;
            });
        }

        function setThemeMode(m) { themeMode = m; updateQuiet(); }
        function updateQuiet() {
            const bgH = document.getElementById('quietBase').value, bg = safeHexToRgb(bgH), isD = themeMode === 'dark';
            document.getElementById('tm-l').classList.toggle('bg-blue-600', themeMode==='light'); document.getElementById('tm-d').classList.toggle('bg-blue-600', themeMode==='dark');
            let surf, side, bord, txt = isD ? "#FFF" : "#0F172A";
            if(isD) { surf = mixColors({r:255,g:255,b:255}, bg, 0.05); side = mixColors({r:0,g:0,b:0}, bg, 0.15); bord = mixColors({r:255,g:255,b:255}, bg, 0.15); }
            else { surf = mixColors({r:0,g:0,b:0}, bg, 0.03); side = mixColors({r:0,g:0,b:0}, bg, 0.08); bord = mixColors({r:0,g:0,b:0}, bg, 0.12); }
            const p = document.getElementById('uiPreview'); p.style.backgroundColor = bgH; p.style.color = txt; p.style.borderColor = bord.hex;
            document.getElementById('uiSidebar').style.backgroundColor = side.hex; document.getElementById('uiSidebar').style.borderColor = bord.hex;
            document.getElementById('uiContent').style.backgroundColor = surf.hex; document.getElementById('uiContent').style.borderColor = bord.hex;
            document.getElementById('quietOutput').innerText = `$bg: ${bgH};\n$surface: ${surf.hex};\n$sidebar: ${side.hex};`;
        }

        function updateGlass() {
            const ctxH = document.getElementById('glassContext').value, vbgH = document.getElementById('glassVisualBg').value, op = document.getElementById('glassOpacity').value/100, blur = document.getElementById('glassBlur').value;
            const ctx = safeHexToRgb(ctxH); document.getElementById('glassOpacityVal').innerText = (op*100) + "%"; document.getElementById('glassBlurVal').innerText = blur + "px";
            const tint = getYIQ(ctx) >= 128 ? {r:0,g:0,b:0} : {r:255,g:255,b:255}, bRgb = mixColors(ctx, tint, 0.8), bRgba = `rgba(${bRgb.r},${bRgb.g},${bRgb.b},0.3)`;
            const pRgba = getYIQ(ctx) >= 128 ? `rgba(255,255,255,${op})` : `rgba(${ctx.r},${ctx.g},${ctx.b},${op})`;
            const pane = document.getElementById('glassPreviewPane'); pane.style.background = pRgba; pane.style.backdropFilter = `blur(${blur}px)`; pane.style.borderColor = bRgba; pane.style.color = getYIQ(safeHexToRgb(vbgH)) >= 128 ? "#000" : "#fff";
            document.getElementById('glassOutput').innerText = `.glass {\n  background: ${pRgba};\n  backdrop-filter: blur(${blur}px);\n  border: 1px solid ${bRgba};\n}`;
        }

        function updateGradient() {
            const s = document.getElementById('gradStart').value, e = document.getElementById('gradEnd').value, ang = document.getElementById('gradAngle').value, soft = document.getElementById('gradSoft').checked;
            document.getElementById('gradAngleVal').innerText = ang + "deg";
            let css = soft ? `linear-gradient(${ang}deg, ${s} 0%, ${mixColors(safeHexToRgb(s), safeHexToRgb(e), 0.5).hex} 50%, ${e} 100%)` : `linear-gradient(${ang}deg, ${s}, ${e})`;
            document.getElementById('gradPreview').style.background = css; document.getElementById('gradOutput').innerText = `background: ${css};`;
        }

        function updateTypo() {
            const b = parseInt(document.getElementById('typoBase').value), r = parseFloat(document.getElementById('typoRatio').value);
            const prev = document.getElementById('typoPreview'); prev.innerHTML = ''; let scss = '$typo: (\n';
            const ns = ['4xl','3xl','2xl','xl','lg','base','sm','xs'];
            ns.forEach((n,i) => {
                const s = (b * Math.pow(r, 4-i)).toFixed(2);
                prev.innerHTML += `<div class="flex items-baseline"><span class="w-12 text-[10px] font-black opacity-40 uppercase">${n}</span><span style="font-size:${s}px" class="font-bold truncate">Interface Typography</span><span class="ml-auto opacity-30 text-[10px]">${s}px</span></div>`;
                scss += `  "${n}": ${s}px,\n`;
            });
            scss += ');'; document.getElementById('typoOutput').innerText = scss;
        }

        function updateShadow() {
            const cH = document.getElementById('shadColor').value, vbgH = document.getElementById('shadVisualBg').value, intensity = parseInt(document.getElementById('shadIntensity').value) / 100;
            const c = safeHexToRgb(cH); document.getElementById('shadPreviewContainer').style.backgroundColor = vbgH;
            const ls = [{y:1,b:2,o:0.1*intensity}, {y:4,b:8,o:0.2*intensity}, {y:12,b:24,o:0.3*intensity}, {y:32,b:64,o:0.4*intensity}];
            const css = ls.map(l => `0 ${l.y}px ${l.b}px rgba(${c.r},${c.g},${c.b},${l.o.toFixed(2)})`).join(', ');
            document.getElementById('shadPreviewBox').style.boxShadow = css;
            document.getElementById('shadOutput').innerText = `box-shadow: ${css};`;
        }

        function handleVisualBgImage(input, containerId) { const f = input.files[0]; if(!f) return; const r = new FileReader(); r.onload = (e) => document.getElementById(containerId).style.backgroundImage = `url(${e.target.result})`; r.readAsDataURL(f); }

        function showTab(id) {
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('panel-' + id).classList.remove('hidden');
            document.getElementById('tab-' + id).classList.add('active');
        }

        function copyContent(e, id) {
            const ta = document.createElement("textarea"); ta.value = document.getElementById(id).innerText; document.body.appendChild(ta); ta.select(); document.execCommand("copy"); document.body.removeChild(ta);
            const btn = e.currentTarget; btn.innerText = "COPIED!"; setTimeout(()=>btn.innerText = "Copy", 1200);
        }

        window.onload = () => {
            updateShift(); updateMix(); updateContrast(); updateRule(); updateSemantic(); updateScale(); updateExplorer(); updateQuiet(); updateGlass(); updateGradient(); updateTypo(); updateShadow(); updateLayout(); updateAccess();
        };
    </script>
</body>
</html>