<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Felix Maywald / RaptorXilef">
    <meta name="copyright" content="¬© [2025] Felix Maywald">
    <!-- Quelle (GitHub-Repository) -->
    <!-- Quelle: https://github.com/RaptorXilef/color-architect-suite -->
    <title>Color Architect Suite</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&family=Fira+Code:wght@400;500&display=swap');
        
        :root {
            --panel-bg: #1e293b;
            --app-bg: #0f172a;
            --accent: #3b82f6;
        }

        body { background-color: var(--app-bg); color: #f8fafc; font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; }
        .card { background: var(--panel-bg); border: 1px solid #334155; border-radius: 1.25rem; box-shadow: 0 20px 50px rgba(0,0,0,0.4); }
        
        /* Custom Inputs */
        input[type="color"] { -webkit-appearance: none; border: none; width: 100%; height: 50px; cursor: pointer; border-radius: 0.75rem; background: #334155; padding: 4px; }
        input[type="color"]::-webkit-color-swatch-wrapper { padding: 0; }
        input[type="color"]::-webkit-color-swatch { border: none; border-radius: 0.5rem; }
        
        input[type="text"], input[type="number"], select { background: #0f172a; border: 1px solid #334155; padding: 0.75rem; border-radius: 0.75rem; color: white; width: 100%; text-align: center; font-family: 'Fira Code', monospace; font-size: 0.875rem; outline: none; }
        input:focus { border-color: var(--accent); }

        /* Tabs */
        .tab-btn { transition: all 0.2s; border-bottom: 3px solid transparent; color: #64748b; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; font-size: 0.7rem; padding: 1rem 0.5rem; }
        .tab-btn.active { border-bottom-color: var(--accent); color: var(--accent); background: rgba(59, 130, 246, 0.05); }

        .code-block { background: #0a0f1e; border-radius: 0.75rem; padding: 1.25rem; font-family: 'Fira Code', monospace; font-size: 0.8rem; border: 1px solid #1e293b; position: relative; overflow-x: auto; color: #94a3b8; }
        .copy-btn { position: absolute; top: 0.75rem; right: 0.75rem; background: #334155; padding: 0.3rem 0.6rem; border-radius: 0.4rem; font-size: 0.65rem; cursor: pointer; color: #cbd5e1; font-weight: bold; }
        .copy-btn:hover { background: var(--accent); color: white; }

        .custom-range { -webkit-appearance: none; width: 100%; height: 6px; background: #334155; border-radius: 5px; outline: none; }
        .custom-range::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 20px; height: 20px; background: var(--accent); cursor: pointer; border-radius: 50%; border: 3px solid #f8fafc; }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        /* Animations */
        .tab-panel { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Grid for Glass Preview */
        .glass-bg-pattern {
            background-image: radial-gradient(circle at 2px 2px, #334155 1px, transparent 0);
            background-size: 24px 24px;
        }
    </style>
</head>
<body class="p-4 md:p-12 flex flex-col items-center">

    <div class="max-w-6xl w-full">
        <!-- Header -->
        <header class="mb-12 text-center">
            <h1 class="text-5xl font-black tracking-tighter bg-clip-text text-transparent bg-gradient-to-r from-blue-400 via-indigo-500 to-emerald-400 uppercase">
                Color Architect Suite
            </h1>
            <p class="text-slate-400 mt-4 text-lg font-medium">Design-Engineering f√ºr Perfektionisten</p>
        </header>

        <!-- Navigation -->
        <div class="overflow-x-auto w-full mb-12 no-scrollbar">
            <nav class="flex min-w-max justify-start md:justify-center space-x-6 md:space-x-10 border-b border-slate-800">
                <button onclick="showTab('mix')" id="tab-mix" class="tab-btn active">Mix Analyzer</button>
                <button onclick="showTab('contrast')" id="tab-contrast" class="tab-btn">WCAG & YIQ</button>
                <button onclick="showTab('rule')" id="tab-rule" class="tab-btn">60-30-10 Rule</button>
                <button onclick="showTab('semantic')" id="tab-semantic" class="tab-btn">UI Semantics</button>
                <button onclick="showTab('scale')" id="tab-scale" class="tab-btn">Scale Pro</button>
                <button onclick="showTab('explorer')" id="tab-explorer" class="tab-btn">Explorer</button>
                <button onclick="showTab('quiet')" id="tab-quiet" class="tab-btn">Theme Architect</button>
                <button onclick="showTab('glass')" id="tab-glass" class="tab-btn text-emerald-400">Glass Architect</button>
            </nav>
        </div>

        <!-- Panels -->
        <div class="space-y-10">

            <!-- 1. MIX ANALYZER -->
            <div id="panel-mix" class="tab-panel">
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="card p-10">
                        <h2 class="text-2xl font-bold mb-8 flex items-center"><span class="mr-3 text-blue-400">üß™</span> SCSS Mix-Calculator</h2>
                        <div class="space-y-8">
                            <div>
                                <label class="block text-[11px] font-black uppercase text-slate-500 mb-3 tracking-widest">Basisfarbe (z.B. Primary)</label>
                                <input type="color" id="mixBaseColor" value="#3b82f6" oninput="syncHex('mixBaseColor', 'mixBaseHex'); updateMix();">
                                <input type="text" id="mixBaseHex" value="#3b82f6" onchange="syncColor('mixBaseHex', 'mixBaseColor'); updateMix();" class="mt-3">
                            </div>
                            <div>
                                <label class="block text-[11px] font-black uppercase text-slate-500 mb-3 tracking-widest">Ziel-Farbe (Alt-Design)</label>
                                <input type="color" id="mixTargetColor" value="#1d4ed8" oninput="syncHex('mixTargetColor', 'mixTargetHex'); updateMix();">
                                <input type="text" id="mixTargetHex" value="#1d4ed8" onchange="syncColor('mixTargetHex', 'mixTargetColor'); updateMix();" class="mt-3">
                            </div>
                        </div>
                    </div>
                    <div class="card p-10 bg-slate-900/40 border-dashed border-slate-700">
                        <h3 class="text-xs font-black text-slate-500 uppercase tracking-widest mb-6">Ergebnis f√ºr dein SCSS</h3>
                        <div class="code-block text-emerald-400">
                            <button class="copy-btn" onclick="copyContent(event, 'mixOutput')">Copy</button>
                            <code id="mixOutput">mix(black, $brand-primary, 15%)</code>
                        </div>
                        <p class="mt-8 text-slate-400 text-sm italic">Berechnet, wie viel % Wei√ü oder Schwarz in deine Basisfarbe gemischt werden muss, um das Alt-Ergebnis zu erhalten.</p>
                    </div>
                </div>
            </div>

            <!-- 2. CONTRAST / WCAG -->
            <div id="panel-contrast" class="tab-panel hidden">
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="card p-10">
                        <h2 class="text-2xl font-bold mb-8">üëÅÔ∏è WCAG & YIQ Analyzer</h2>
                        <div class="space-y-8">
                            <div>
                                <label class="block text-[11px] font-black uppercase text-slate-500 mb-3">Hintergrundfarbe</label>
                                <input type="color" id="conBgColor" value="#3b82f6" oninput="updateContrast();">
                            </div>
                            <div class="pt-8 border-t border-slate-700 grid grid-cols-2 gap-6">
                                <div><label class="block text-[10px] font-bold text-slate-500 mb-2">Text Dunkel</label><input type="color" id="conDarkText" value="#0f172a" oninput="updateContrast();"></div>
                                <div><label class="block text-[10px] font-bold text-slate-500 mb-2">Text Hell</label><input type="color" id="conLightText" value="#f8fafc" oninput="updateContrast();"></div>
                            </div>
                        </div>
                    </div>
                    <div class="card overflow-hidden flex flex-col shadow-2xl">
                        <div id="conPreview" class="flex-grow p-16 flex flex-col items-center justify-center text-center transition-all duration-500">
                            <h3 id="conPreviewText" class="text-4xl font-black mb-4 tracking-tighter uppercase text-white">Vorschau</h3>
                            <p id="ratioRes" class="text-xl font-mono font-bold"></p>
                        </div>
                        <div id="wcagBadge" class="p-4 text-center text-xs font-black uppercase tracking-widest text-white">Check...</div>
                    </div>
                </div>
            </div>

            <!-- 3. 60-30-10 RULE -->
            <div id="panel-rule" class="tab-panel hidden">
                <div class="card p-10">
                    <div class="flex flex-col md:flex-row justify-between items-center mb-12 gap-6">
                        <h2 class="text-2xl font-bold">üìê Prozeduraler Designer</h2>
                        <div class="flex p-1.5 bg-slate-900 rounded-xl border border-slate-700">
                            <button onclick="setRuleMode('light')" id="rule-l" class="px-6 py-2 text-[11px] font-black rounded-lg uppercase transition-all">Light</button>
                            <button onclick="setRuleMode('dark')" id="rule-d" class="px-6 py-2 text-[11px] font-black rounded-lg uppercase transition-all ml-2 bg-blue-600">Dark</button>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-3 gap-12">
                        <div class="space-y-8">
                            <label class="block text-[11px] font-black uppercase text-blue-400 mb-2">Akzentfarbe (10%)</label>
                            <input type="color" id="ruleAccent" value="#3b82f6" oninput="updateRule();">
                        </div>
                        <div class="md:col-span-2 space-y-8">
                            <div class="h-32 rounded-2xl flex overflow-hidden shadow-2xl border border-slate-800" id="ruleBar"></div>
                            <div class="code-block text-blue-300">
                                <pre id="ruleOutput" class="text-xs"></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 4. UI SEMANTIC -->
            <div id="panel-semantic" class="tab-panel hidden">
                <div class="grid md:grid-cols-3 gap-8">
                    <div class="card p-10">
                        <h2 class="text-2xl font-bold mb-6">üé® UI Semantics</h2>
                        <label class="block text-[11px] font-bold uppercase text-slate-500 mb-4 tracking-widest">Markenfarbe (Einfluss: 20%)</label>
                        <input type="color" id="semBase" value="#3b82f6" oninput="updateSemantic();">
                    </div>
                    <div class="md:col-span-2 card p-10">
                        <div class="grid grid-cols-2 gap-6" id="semContainer"></div>
                        <div class="code-block mt-8 text-emerald-400">
                            <pre id="semOutput" class="text-xs"></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 5. SCALE PRO -->
            <div id="panel-scale" class="tab-panel hidden">
                <div class="card p-10">
                    <div class="flex flex-col md:flex-row justify-between items-center mb-10 gap-6">
                        <h2 class="text-2xl font-bold">ü™ú Scale Pro</h2>
                        <div class="flex p-1.5 bg-slate-900 rounded-xl border border-slate-700">
                            <button onclick="setScaleType('mono')" id="sc-mono" class="px-5 py-2 text-[10px] font-black rounded-lg uppercase bg-blue-600">Monochrom</button>
                            <button onclick="setScaleType('duo')" id="sc-duo" class="px-5 py-2 text-[10px] font-black rounded-lg uppercase ml-2">Duo-Gradient</button>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-4 gap-10">
                        <div class="space-y-6">
                            <div><label class="block text-[10px] font-bold mb-2 uppercase">Farbe A</label><input type="color" id="scaleA" value="#3b82f6" oninput="updateScale();"></div>
                            <div id="scaleBWrapper" class="hidden"><label class="block text-[10px] font-bold mb-2 uppercase">Farbe B</label><input type="color" id="scaleB" value="#10b981" oninput="updateScale();"></div>
                            <div><label class="block text-[10px] font-bold mb-2 uppercase">Stufen: <span id="scCountText">7</span></label><input type="range" id="scaleCount" min="3" max="15" step="2" value="7" oninput="updateScale();" class="custom-range"></div>
                        </div>
                        <div class="md:col-span-3 space-y-8">
                            <div id="scalePreview" class="h-20 flex rounded-2xl overflow-hidden shadow-xl border border-slate-700"></div>
                            <div class="code-block text-blue-300"><pre id="scaleOutput" class="text-xs"></pre></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 6. EXPLORER -->
            <div id="panel-explorer" class="tab-panel hidden">
                <div class="grid md:grid-cols-3 gap-8">
                    <div class="card p-10">
                        <h2 class="text-2xl font-bold mb-6">üîç Explorer</h2>
                        <label class="block text-[11px] font-bold uppercase text-slate-500 mb-4 tracking-widest">Hintergrundfarbe</label>
                        <input type="color" id="expBase" value="#0f172a" oninput="updateExplorer();">
                    </div>
                    <div class="md:col-span-2 space-y-4 max-h-[500px] overflow-y-auto pr-2 no-scrollbar" id="expResults"></div>
                </div>
            </div>

            <!-- 7. THEME ARCHITECT -->
            <div id="panel-quiet" class="tab-panel hidden">
                <div class="grid md:grid-cols-3 gap-8">
                    <div class="card p-10 border-emerald-500/20">
                        <h2 class="text-2xl font-bold text-emerald-400 mb-8">üåø Theme Architect</h2>
                        <div class="space-y-8">
                            <div>
                                <label class="block text-[11px] font-black uppercase text-slate-500 mb-3 tracking-widest">Hauptfarbe (Basis)</label>
                                <input type="color" id="quietBase" value="#0A192F" oninput="updateQuiet();">
                            </div>
                            <div class="flex p-1.5 bg-slate-900 rounded-xl border border-slate-800">
                                <button onclick="setThemeMode('light')" id="tm-l" class="flex-1 py-2 text-[10px] font-black rounded-lg uppercase">Light</button>
                                <button onclick="setThemeMode('dark')" id="tm-d" class="flex-1 py-2 text-[10px] font-black rounded-lg uppercase ml-2 bg-blue-600">Dark</button>
                            </div>
                        </div>
                    </div>
                    <div class="md:col-span-2 space-y-8">
                        <!-- UI PREVIEW -->
                        <div id="uiPreview" class="rounded-3xl p-8 flex border transition-all duration-500 shadow-2xl relative overflow-hidden" style="min-height: 250px;">
                            <div id="uiSidebar" class="w-1/3 rounded-2xl p-4 border transition-all duration-500 mr-6">
                                <div class="w-full h-4 rounded-full opacity-20 mb-3 bg-current"></div>
                                <div class="w-2/3 h-4 rounded-full opacity-10 bg-current"></div>
                            </div>
                            <div id="uiContent" class="flex-1 rounded-2xl p-6 border transition-all duration-500 relative">
                                <h4 class="font-bold text-lg mb-4">UI Preview</h4>
                                <div class="w-full h-24 rounded-xl mb-4 bg-current opacity-5 border border-current"></div>
                            </div>
                        </div>
                        <div class="code-block text-emerald-300">
                            <button class="copy-btn" onclick="copyContent(event, 'quietOutput')">Copy Theme</button>
                            <pre id="quietOutput" class="text-xs"></pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 8. GLASS ARCHITECT (NEW) -->
            <div id="panel-glass" class="tab-panel hidden">
                <div class="grid md:grid-cols-3 gap-8">
                    <div class="card p-10">
                        <h2 class="text-2xl font-bold text-emerald-400 mb-8">üíé Glass Architect</h2>
                        <div class="space-y-8">
                            <div>
                                <label class="block text-[11px] font-black uppercase text-slate-500 mb-3 tracking-widest">Hintergrund-Kontext</label>
                                <input type="color" id="glassBg" value="#0f172a" oninput="updateGlass();">
                            </div>
                            <div>
                                <label class="block text-[10px] font-bold text-slate-500 mb-2 uppercase tracking-tighter">Deckkraft: <span id="glassOpacityVal">20%</span></label>
                                <input type="range" id="glassOpacity" min="5" max="60" step="5" value="20" oninput="updateGlass();" class="custom-range">
                            </div>
                            <div>
                                <label class="block text-[10px] font-bold text-slate-500 mb-2 uppercase tracking-tighter">Blur (Weichzeichnung): <span id="glassBlurVal">12px</span></label>
                                <input type="range" id="glassBlur" min="0" max="40" step="1" value="12" oninput="updateGlass();" class="custom-range">
                            </div>
                            <p class="text-xs text-slate-400 leading-relaxed italic border-t border-slate-700 pt-6">
                                Berechnet die ideale Rahmenfarbe (Border Tint) durch mathematisches Mischen des Hintergrunds mit Wei√ü.
                            </p>
                        </div>
                    </div>
                    <div class="md:col-span-2 space-y-8">
                        <!-- GLASS PREVIEW -->
                        <div class="rounded-3xl p-16 glass-bg-pattern flex items-center justify-center relative overflow-hidden border border-slate-800 shadow-2xl" style="min-height: 350px;">
                            <div id="glassPreviewPane" class="w-full max-w-sm p-8 rounded-3xl border transition-all duration-300 flex flex-col items-center">
                                <div class="w-16 h-16 rounded-full bg-gradient-to-tr from-emerald-400 to-blue-500 mb-6 shadow-lg"></div>
                                <h4 class="text-xl font-black tracking-tight mb-2">Frosted Glass</h4>
                                <p class="text-xs opacity-60 text-center leading-relaxed">Mathematisch korrekte Reflektion und Rahmenfarbe.</p>
                            </div>
                        </div>
                        <div class="code-block text-emerald-300">
                            <button class="copy-btn" onclick="copyContent(event, 'glassOutput')">Copy CSS</button>
                            <pre id="glassOutput" class="text-xs"></pre>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- GLOBALS ---
        let ruleMode = 'dark';
        let scaleType = 'mono';
        let themeMode = 'dark';

        // --- MATH HELPERS ---
        const hexToRgb = (hex) => {
            const r = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return r ? { r: parseInt(r[1], 16), g: parseInt(r[2], 16), b: parseInt(r[3], 16) } : null;
        };
        const rgbToHex = (r, g, b) => "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        const mix = (c1, c2, weight) => {
            const r = Math.round(c1.r * weight + c2.r * (1 - weight));
            const g = Math.round(c1.g * weight + c2.g * (1 - weight));
            const b = Math.round(c1.b * weight + c2.b * (1 - weight));
            return { r, g, b, hex: rgbToHex(r, g, b) };
        };
        const getYIQ = (rgb) => ((rgb.r * 299) + (rgb.g * 587) + (rgb.b * 114)) / 1000;
        const getLuminance = (rgb) => {
            let a = [rgb.r, rgb.g, rgb.b].map(v => { v /= 255; return v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4); });
            return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722;
        };
        const getContrast = (rgb1, rgb2) => {
            let l1 = getLuminance(rgb1) + 0.05, l2 = getLuminance(rgb2) + 0.05;
            return l1 > l2 ? l1 / l2 : l2 / l1;
        };
        const rgbToHsl = (r, g, b) => {
            r /= 255, g /= 255, b /= 255;
            let max = Math.max(r, g, b), min = Math.min(r, g, b), h, s, l = (max + min) / 2;
            if(max == min) { h = s = 0; } else {
                let d = max - min; s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch(max){ case r: h = (g - b) / d + (g < b ? 6 : 0); break; case g: h = (b - r) / d + 2; break; case b: h = (r - g) / d + 4; break; }
                h /= 6;
            } return { h: h * 360, s: s * 100, l: l * 100 };
        };
        const hslToRgb = (h, s, l) => {
            s /= 100; l /= 100; h /= 360;
            let r, g, b;
            if(s == 0){ r = g = b = l; } else {
                const q2r = (p, q, t) => { if(t < 0) t += 1; if(t > 1) t -= 1; if(t < 1/6) return p + (q - p) * 6 * t; if(t < 1/2) return q; if(t < 2/3) return p + (q - p) * (2/3 - t) * 6; return p; };
                let q = l < 0.5 ? l * (1 + s) : l + s - l * s, p = 2 * l - q;
                r = q2r(p, q, h + 1/3); g = q2r(p, q, h); b = q2r(p, q, h - 1/3);
            } return { r: Math.round(r * 255), g: Math.round(g * 255), b: Math.round(b * 255), hex: rgbToHex(Math.round(r*255), Math.round(g*255), Math.round(b*255)) };
        };

        // --- SYSTEM ---
        function showTab(id) {
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.add('hidden'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            const panel = document.getElementById('panel-' + id);
            if(panel) panel.classList.remove('hidden');
            const btn = document.getElementById('tab-' + id);
            if(btn) btn.classList.add('active');
        }

        function syncHex(cId, hId) { const c = document.getElementById(cId), h = document.getElementById(hId); if(c && h) h.value = c.value.toUpperCase(); }
        function syncColor(hId, cId) { const c = document.getElementById(cId), h = document.getElementById(hId); if(c && h && /^#[0-9A-F]{6}$/i.test(h.value)) c.value = h.value; }

        function copyContent(e, id) {
            const el = document.getElementById(id);
            if(!el) return;
            const ta = document.createElement("textarea"); ta.value = el.innerText; document.body.appendChild(ta); ta.select(); document.execCommand("copy"); document.body.removeChild(ta);
            const btn = e.currentTarget; const old = btn.innerText; btn.innerText = "Copied!"; setTimeout(()=>btn.innerText = old, 1200);
        }

        // --- UPDATERS ---
        function updateMix() {
            const bIn = document.getElementById('mixBaseColor'), tIn = document.getElementById('mixTargetColor');
            if(!bIn || !tIn) return;
            const b = hexToRgb(bIn.value), t = hexToRgb(tIn.value);
            if(!b || !t) return;
            const bAvg = (b.r + b.g + b.b)/3, tAvg = (t.r + t.g + t.b)/3;
            let partner = tAvg > bAvg ? {r:255, g:255, b:255, name:'white'} : {r:0, g:0, b:0, name:'black'};
            const ds = [(t.r-b.r)/(partner.r-b.r), (t.g-b.g)/(partner.g-b.g), (t.b-b.b)/(partner.b-b.b)].filter(v=>isFinite(v)&&!isNaN(v));
            const p = ds.length > 0 ? Math.round((ds.reduce((x,y)=>x+y)/ds.length)*100) : 0;
            document.getElementById('mixOutput').innerText = `mix(${partner.name}, $brand-primary, ${Math.max(0, p)}%)`;
        }

        function updateContrast() {
            const bgIn = document.getElementById('conBgColor'), darkIn = document.getElementById('conDarkText'), lightIn = document.getElementById('conLightText');
            if(!bgIn || !darkIn || !lightIn) return;
            const bg = hexToRgb(bgIn.value), dark = hexToRgb(darkIn.value), light = hexToRgb(lightIn.value);
            const isL = getYIQ(bg) >= 128;
            const txt = isL ? dark : light, txtHex = isL ? darkIn.value : lightIn.value;
            const ratio = getContrast(bg, txt).toFixed(2);
            const prev = document.getElementById('conPreview');
            if(prev) {
                prev.style.backgroundColor = bgIn.value;
                document.getElementById('conPreviewText').style.color = txtHex;
                document.getElementById('ratioRes').innerText = `${ratio} : 1`;
                const badge = document.getElementById('wcagBadge');
                if (ratio >= 7) {badge.innerText = "AAA - EXZELLENT";}
                else if (ratio >= 4.5) {badge.innerText = "AA - BESTANDEN";}
                else {badge.innerText = "KRITISCH";}
                badge.style.backgroundColor = ratio >= 4.5 ? "#10b981" : "#ef4444";
            }
        }

        function setRuleMode(m) { ruleMode = m; updateRule(); }
        function updateRule() {
            const accIn = document.getElementById('ruleAccent');
            if(!accIn) return;
            const acc = hexToRgb(accIn.value);
            let b = ruleMode === 'light' ? "#F8FAFC" : "#0F172A";
            let s = ruleMode === 'light' ? mix(acc, {r:255,g:255,b:255}, 0.1).hex : mix(acc, {r:15,g:23,b:42}, 0.15).hex;
            const bar = document.getElementById('ruleBar');
            if(bar) {
                bar.innerHTML = `<div style="width:60%; background:${b}"></div><div style="width:30%; background:${s}"></div><div style="width:10%; background:${accIn.value}"></div>`;
                document.getElementById('ruleOutput').innerText = `$base: ${b};\n$secondary: ${s};\n$accent: ${accIn.value};`;
                document.getElementById('rule-l').classList.toggle('bg-blue-600', ruleMode==='light');
                document.getElementById('rule-d').classList.toggle('bg-blue-600', ruleMode==='dark');
            }
        }

        function updateSemantic() {
            const bIn = document.getElementById('semBase');
            if(!bIn) return;
            const brand = hexToRgb(bIn.value);
            const states = [{n:'Info', c:{r:59,g:130,b:246}}, {n:'Success', c:{r:34,g:197,b:94}}, {n:'Warning', c:{r:234,g:179,b:8}}, {n:'Danger', c:{r:239,g:68,b:68}}];
            const cont = document.getElementById('semContainer');
            if(!cont) return;
            cont.innerHTML = '';
            let scss = '$semantic-tokens: (\n';
            states.forEach(s => {
                const tint = mix(brand, s.c, 0.2);
                const isL = getYIQ(tint) >= 128;
                const txt = isL ? "#000" : "#fff";
                cont.innerHTML += `<div class="p-5 rounded-2xl flex flex-col items-center justify-center font-bold text-xs shadow-lg" style="background:${tint.hex}; color:${txt}"><span>${s.n}</span><span class="opacity-50 font-mono mt-1">${tint.hex}</span></div>`;
                scss += `  "${s.n.toLowerCase()}": ( "bg": ${tint.hex}, "text": ${txt} ),\n`;
            });
            scss += ');'; document.getElementById('semOutput').innerText = scss;
        }

        function setScaleType(t) { scaleType = t; updateScale(); }
        function updateScale() {
            const aIn = document.getElementById('scaleA'), bIn = document.getElementById('scaleB'), cIn = document.getElementById('scaleCount');
            if(!aIn || !bIn || !cIn) return;
            const a = hexToRgb(aIn.value), b = hexToRgb(bIn.value), count = parseInt(cIn.value);
            document.getElementById('scCountText').innerText = count;
            document.getElementById('sc-mono').classList.toggle('bg-blue-600', scaleType==='mono');
            document.getElementById('sc-duo').classList.toggle('bg-blue-600', scaleType==='duo');
            document.getElementById('scaleBWrapper').classList.toggle('hidden', scaleType!=='duo');
            const prev = document.getElementById('scalePreview');
            if(!prev) return;
            prev.innerHTML = '';
            let scss = '$color-scale: (\n';
            for(let i=0; i<count; i++) {
                const w = i / (count-1);
                let c = scaleType === 'mono' ? (w < 0.5 ? mix(a, {r:255,g:255,b:255}, w*2) : mix({r:0,g:0,b:0}, a, (w-0.5)*2)) : mix(b, a, w);
                prev.innerHTML += `<div style="flex:1; background:${c.hex}"></div>`;
                scss += `  "${(i+1)*100}": ${c.hex},\n`;
            }
            scss += ');'; document.getElementById('scaleOutput').innerText = scss;
        }

        function updateExplorer() {
            const bIn = document.getElementById('expBase');
            if(!bIn) return;
            const bg = hexToRgb(bIn.value), hsl = rgbToHsl(bg.r, bg.g, bg.b);
            const res = document.getElementById('expResults');
            if(!res) return;
            res.innerHTML = '';
            const hars = [{n:'Komplement√§r', h:180}, {n:'Triadisch A', h:120}, {n:'Triadisch B', h:240}, {n:'Analog A', h:30}, {n:'Analog B', h:330}];
            hars.forEach(h => {
                const acc = hslToRgb((hsl.h + h.h) % 360, Math.max(hsl.s, 60), Math.max(hsl.l, 50));
                const ratio = getContrast(bg, acc).toFixed(1);
                res.innerHTML += `<div class="card p-5 flex items-center justify-between border-l-4" style="border-left-color:${acc.hex}">
                    <div><p class="text-[10px] font-bold text-slate-500 uppercase">${h.n}</p><p class="font-mono text-sm">${acc.hex}</p></div>
                    <div class="flex items-center space-x-6">
                        <div class="px-4 py-2 rounded-lg font-bold text-xs shadow" style="background:${acc.hex}; color:${getYIQ(acc)>=128?'#000':'#fff'}">Button</div>
                        <div class="text-right"><p class="text-[10px] font-bold text-slate-500 uppercase text-slate-500">Contrast</p><p class="text-sm font-bold ${ratio>=4.5?'text-emerald-400':'text-red-400'}">${ratio}:1</p></div>
                    </div>
                </div>`;
            });
        }

        function setThemeMode(m) { themeMode = m; updateQuiet(); }
        function updateQuiet() {
            const bIn = document.getElementById('quietBase');
            if(!bIn) return;
            const bg = hexToRgb(bIn.value);
            const isDark = themeMode === 'dark';

            document.getElementById('tm-l').classList.toggle('bg-blue-600', !isDark);
            document.getElementById('tm-d').classList.toggle('bg-blue-600', isDark);

            let surf, side, bord, shad, txt = isDark ? "#FFFFFF" : "#0F172A";
            if(isDark) {
                surf = mix({r:255,g:255,b:255}, bg, 0.05);
                side = mix({r:0,g:0,b:0}, bg, 0.15);
                bord = mix({r:255,g:255,b:255}, bg, 0.15);
                shad = mix({r:0,g:0,b:0}, bg, 0.40);
            } else {
                surf = mix({r:0,g:0,b:0}, bg, 0.03);
                side = mix({r:0,g:0,b:0}, bg, 0.08);
                bord = mix({r:0,g:0,b:0}, bg, 0.12);
                shad = mix({r:0,g:0,b:0}, bg, 0.10);
            }

            const prev = document.getElementById('uiPreview');
            if(prev) {
                prev.style.backgroundColor = bIn.value; prev.style.color = txt; prev.style.borderColor = bord.hex;
                document.getElementById('uiSidebar').style.backgroundColor = side.hex;
                document.getElementById('uiSidebar').style.borderColor = bord.hex;
                document.getElementById('uiContent').style.backgroundColor = surf.hex;
                document.getElementById('uiContent').style.borderColor = bord.hex;
                document.getElementById('uiContent').style.boxShadow = `10px 10px 30px ${shad.hex}`;
                document.getElementById('quietOutput').innerText =
`// Theme Architect: ${themeMode.toUpperCase()}
$theme-bg:      ${bIn.value};
$theme-surface: ${surf.hex};
$theme-sidebar: ${side.hex};
$theme-border:  ${bord.hex};
$theme-shadow:  ${shad.hex};
$theme-text:    ${txt};`;
            }
        }

        // --- NEW: GLASS ARCHITECT ---
        function updateGlass() {
            const bgHex = document.getElementById('glassBg').value;
            const op = document.getElementById('glassOpacity').value / 100;
            const blur = document.getElementById('glassBlur').value;
            const bg = hexToRgb(bgHex);
            
            document.getElementById('glassOpacityVal').innerText = (op*100) + "%";
            document.getElementById('glassBlurVal').innerText = blur + "px";

            const isLight = getYIQ(bg) >= 128;
            
            // Border Tint: Mix background with white/black to get harmonious border
            const tintBase = isLight ? {r:0,g:0,b:0} : {r:255,g:255,b:255};
            const borderRgb = mix(bg, tintBase, 0.7); // 30% white/black tint
            const borderRgba = `rgba(${borderRgb.r}, ${borderRgb.g}, ${borderRgb.b}, 0.4)`;
            
            const paneRgba = isLight ? `rgba(255, 255, 255, ${op})` : `rgba(15, 23, 42, ${op})`;
            const text = isLight ? "#000" : "#fff";

            const pane = document.getElementById('glassPreviewPane');
            pane.style.background = paneRgba;
            pane.style.backdropFilter = `blur(${blur}px)`;
            pane.style.borderColor = borderRgba;
            pane.style.color = text;

            document.getElementById('glassOutput').innerText = 
`.glass-card {
  background: ${paneRgba};
  backdrop-filter: blur(${blur}px);
  -webkit-backdrop-filter: blur(${blur}px);
  border: 1px solid ${borderRgba};
  border-radius: 24px;
  color: ${text};
}`;
        }

        // --- INIT ---
        window.onload = () => {
            updateMix(); updateContrast(); setRuleMode('dark'); updateSemantic(); setScaleType('mono'); updateExplorer(); setThemeMode('dark'); updateGlass();
        };
    </script>
</body>
</html>